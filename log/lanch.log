[nltk_data] Downloading package punkt to /root/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package stopwords to /root/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
-----------  Configuration Arguments -----------
batch_size: 3000
beam_size: 5
beta1: 0.9
beta2: 0.998
block_trigram: True
candidate_sentence_num: 10
candidate_summary_num: 10
checkpoints: checkpoints
config_path: model_config/roberta_graphsum_config.json
data_path: src/data_preprocess/input_data
dataset: test
decode_path: roberta_results/
decr_every_n_nan_or_inf: 2
decr_ratio: 0.8
dev_set: ./data/examples_dataset/valid
do_dec: True
do_lower_case: True
do_preprocessing: True
do_test: True
do_train: False
do_val: False
encoder_json_file: src/data_preprocess/config/bpe/gpt2_bpe/encoder.json
epoch: 100
eps: 1e-08
ernie_config_path: ernie_config/ernie_config.json
ernie_vocab_file: ernie_config/vocab.txt
evaluate_blue: False
find_opt_num: False
grad_norm: 2.0
graph_type: similarity
in_tokens: True
incr_every_n_steps: 100
incr_ratio: 2.0
init_checkpoint: multinews_extra/
init_loss_scaling: 12800.0
init_pretraining_params: ./roberta_config/roberta.base
is_distributed: False
json_path: src/data_preprocess/json_data/
label_selection_type: greedy_selection
label_smooth_eps: 0.1
learning_rate: 0.03
len_penalty: 0.6
log_file: log/cnndm_test.log
lower: True
lr_scheduler: noam_decay
max_doc_num: 20
max_nsents: 100
max_out_len: 300
max_para_len: 768
max_para_num: 100
max_seq_len: 512
max_src_ntokens: 768
max_tgt_len: 300
metrics: True
min_nsents: 5
min_out_len: 200
min_src_ntokens: 5
mode: 
model_name: multigraphsum
n_cpus: 20
num_iteration_per_drop_scope: 10
num_topics: 20
pos_win: 2.0
process_wiki: False
random_seed: 1
report_orcale: False
report_rouge: True
roberta_config_path: roberta_config/roberta_config.json
roberta_vocab_file: src/data_preprocess/config/bpe/gpt2_bpe/vocab.txt
save_steps: 10000
selected_sentence_num: 9
shard_size: 2000
sim_function: tf-idf
sim_threshold: 0.1
skip_steps: 100
stream_job: 
summary_sent_num: 30
test_set: ./data/examples_dataset/test
test_src: src/data_preprocess/data/example.source
test_tgt: src/data_preprocess/data/example.target
train_set: ./data/examples_dataset/train
use_cuda: False
use_dynamic_loss_scaling: False
use_fast_executor: True
use_fp16: False
use_interval: False
use_multi_gpu_test: False
validation_steps: 20000
verbose: True
vocab_bpe_file: src/data_preprocess/config/bpe/gpt2_bpe/vocab.bpe
vocab_path: src/data_preprocess/config/vocab/spm9998_3.model
warmup_proportion: 0.1
warmup_steps: 10000
weight_decay: 0.01
weight_sharing: True
------------------------------------------------
1.980483
Written test.0.json
2.095944
2.096049
Ignore src/data_preprocess/input_data/test.0.json
2.203852
attention_probs_dropout_prob: 0.1
dec_graph_layers: 6
dec_word_pos_embedding_name: dec_word_pos_embedding
enc_graph_layers: 2
enc_sen_pos_embedding_name: enc_sen_pos_embedding
hidden_act: relu
hidden_dropout_prob: 0.1
initializer_range: 0.02
postprocess_command: da
preprocess_command: n
word_embedding_name: word_embedding
------------------------------------------------
[2021-12-22 13:27:00,879 INFO] {'BOS': 0, 'EOS': 50264, 'PAD': 1, 'EOQ': 2}
attention_probs_dropout_prob: 0.1
hidden_act: gelu
hidden_dropout_prob: 0.1
hidden_size: 768
initializer_range: 0.02
max_position_embeddings: 770
num_attention_heads: 12
num_hidden_layers: 12
sent_type_vocab_size: 0
task_type_vocab_size: 0
type_vocab_size: 0
vocab_size: 50265
------------------------------------------------
[2021-12-22 13:27:00,885 WARNING] paddle.fluid.layers.py_reader() may be deprecated in the near future. Please use paddle.fluid.io.DataLoader.from_generator() instead.
TRuee
[2021-12-22 13:27:02,562 INFO] args.is_distributed: False
HERE
CPUPlace
Load model from multinews_extra/
Following params not existed in the params file:
[]
FROM HERE
src/data_preprocess/input_data
HENAA
src/data_preprocess/input_data
[2021-12-22 13:27:12,160 INFO] Loading dataset from src/data_preprocess/input_data/test.0.json, number of examples: 10
[2021-12-22 13:27:12,161 INFO] Final test result:
[2021-12-22 13:27:12,333 INFO] {'BOS': 0, 'EOS': 50264, 'PAD': 1, 'EOQ': 2}
1640179641	sent_labels_weight	The place is:CPUPlace
Tensor[read_file_0.tmp_7]
	shape: [1,2,14,1,]
	dtype: f
	data: 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,
1640179641	sent_scores	The place is:CPUPlace
Tensor[sent_score_fc.tmp_2]
	shape: [1,2,14,1,]
	dtype: f
	data: 0.114888,0.154458,0.141494,0.124032,0.127038,0.159688,0.163456,0.165024,0.0931377,0.15414,0.124786,0.133958,0.133462,0.134994,0.267758,0.310868,0.404853,0.349727,0.459001,0.0913432,0.0913432,0.0913432,0.0913432,0.0913432,0.0913432,0.0913432,0.0913432,0.0913432,
1640179641	correct_scores	The place is:CPUPlace
Tensor[elementwise_mul_1.tmp_0]
	shape: [1,2,14,1,]
	dtype: f
	data: 0.114888,0.154458,0.141494,0.124032,0.127038,0.159688,0.163456,0.165024,0.0931377,0.15414,0.124786,0.133958,0.133462,0.134994,0.267758,0.310868,0.404853,0.349727,0.459001,0,0,0,0,0,0,0,0,0,
1640179641	score_sorted	The place is:CPUPlace
Tensor[argsort_1.tmp_0]
	shape: [1,28,1,]
	dtype: f
	data: 0.459001,0.404853,0.349727,0.310868,0.267758,0.165024,0.163456,0.159688,0.154458,0.15414,0.141494,0.134994,0.133958,0.133462,0.127038,0.124786,0.124032,0.114888,0.0931377,0,0,0,0,0,0,0,0,0,
1640179641	cand_summary_sent_ids	The place is:CPUPlace
Tensor[argsort_0.tmp_1_slice_0]
	shape: [1,10,1,]
	dtype: l
	data: 18,16,17,15,14,7,6,5,1,9,
1640179654	sent_labels_weight	The place is:CPUPlace
Tensor[read_file_0.tmp_7]
	shape: [1,3,23,1,]
	dtype: f
	data: 1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1640179654	sent_scores	The place is:CPUPlace
Tensor[sent_score_fc.tmp_2]
	shape: [1,3,23,1,]
	dtype: f
	data: 0.136111,0.146656,0.122842,0.0126287,0.0969871,0.0803948,0.097713,0.0677931,0.0207868,0.0207868,0.0207868,0.0207868,0.0207868,0.0207868,0.0207868,0.0207868,0.0207868,0.0207868,0.0207868,0.0207868,0.0207868,0.0207868,0.0207868,0.0955973,0.117963,0.038963,0.0383129,0.0107981,0.0395694,0.0392501,0.0429611,0.0599016,0.076094,0.163744,0.0368079,0.0344257,0.128696,0.17121,0.0859196,0.0627878,0.0591161,0.0584591,0.0573346,0.0567791,0.0850954,0.0850954,0.00804388,0.00660088,0.00974259,0.49345,0.375065,0.51399,0.228873,0.452849,0.503374,0.465979,0.185911,0.278695,0.441356,0.320421,0.190739,0.329038,0.324991,0.197353,0.15242,0.13917,0.136389,0.136749,0.133086,
1640179654	correct_scores	The place is:CPUPlace
Tensor[elementwise_mul_1.tmp_0]
	shape: [1,3,23,1,]
	dtype: f
	data: 0.136111,0.146656,0.122842,0.0126287,0.0969871,0.0803948,0.097713,0.0677931,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0955973,0.117963,0.038963,0.0383129,0.0107981,0.0395694,0.0392501,0.0429611,0.0599016,0.076094,0.163744,0.0368079,0.0344257,0.128696,0.17121,0.0859196,0.0627878,0.0591161,0.0584591,0.0573346,0.0567791,0,0,0.00804388,0.00660088,0.00974259,0.49345,0.375065,0.51399,0.228873,0.452849,0.503374,0.465979,0.185911,0.278695,0.441356,0.320421,0.190739,0.329038,0.324991,0.197353,0.15242,0.13917,0.136389,0.136749,0.133086,
1640179654	score_sorted	The place is:CPUPlace
Tensor[argsort_1.tmp_0]
	shape: [1,69,1,]
	dtype: f
	data: 0.51399,0.503374,0.49345,0.465979,0.452849,0.441356,0.375065,0.329038,0.324991,0.320421,0.278695,0.228873,0.197353,0.190739,0.185911,0.17121,0.163744,0.15242,0.146656,0.13917,0.136749,0.136389,0.136111,0.133086,0.128696,0.122842,0.117963,0.097713,0.0969871,0.0955973,0.0859196,0.0803948,0.076094,0.0677931,0.0627878,0.0599016,0.0591161,0.0584591,0.0573346,0.0567791,0.0429611,0.0395694,0.0392501,0.038963,0.0383129,0.0368079,0.0344257,0.0126287,0.0107981,0.00974259,0.00804388,0.00660088,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
1640179654	cand_summary_sent_ids	The place is:CPUPlace
Tensor[argsort_0.tmp_1_slice_0]
	shape: [1,10,1,]
	dtype: l
	data: 51,54,49,55,53,58,50,61,62,59,
1640179668	sent_labels_weight	The place is:CPUPlace
Tensor[read_file_0.tmp_7]
	shape: [1,3,23,1,]
	dtype: f
	data: 1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
1640179668	sent_scores	The place is:CPUPlace
Tensor[sent_score_fc.tmp_2]
	shape: [1,3,23,1,]
	dtype: f
	data: 0.0660228,0.494616,0.162428,0.437641,0.0316525,0.298523,0.27517,0.291328,0.351385,0.202322,0.438235,0.397383,0.211775,0.0178315,0.162922,0.162922,0.162922,0.162922,0.162922,0.162922,0.162922,0.162922,0.162922,0.0828754,0.0614711,0.263742,0.145444,0.0850753,0.377746,0.288508,0.357374,0.137973,0.162512,0.113618,0.117346,0.145239,0.211193,0.347406,0.160065,0.142928,0.140984,0.140491,0.138793,0.137387,0.136701,0.138247,0.137266,0.140073,0.191541,0.436196,0.236549,0.16836,0.0770289,0.0288053,0.0540757,0.0540757,0.0540757,0.0540757,0.0540757,0.0540757,0.0540757,0.0540757,0.0540757,0.0540757,0.0540757,0.0540757,0.0540757,0.0540757,0.0540757,
1640179668	correct_scores	The place is:CPUPlace
Tensor[elementwise_mul_1.tmp_0]
	shape: [1,3,23,1,]
	dtype: f
	data: 0.0660228,0.494616,0.162428,0.437641,0.0316525,0.298523,0.27517,0.291328,0.351385,0.202322,0.438235,0.397383,0.211775,0.0178315,0,0,0,0,0,0,0,0,0,0.0828754,0.0614711,0.263742,0.145444,0.0850753,0.377746,0.288508,0.357374,0.137973,0.162512,0.113618,0.117346,0.145239,0.211193,0.347406,0.160065,0.142928,0.140984,0.140491,0.138793,0.137387,0.136701,0.138247,0.137266,0.140073,0.191541,0.436196,0.236549,0.16836,0.0770289,0.0288053,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
1640179668	score_sorted	The place is:CPUPlace
Tensor[argsort_1.tmp_0]
	shape: [1,69,1,]
	dtype: f
	data: 0.494616,0.438235,0.437641,0.436196,0.397383,0.377746,0.357374,0.351385,0.347406,0.298523,0.291328,0.288508,0.27517,0.263742,0.236549,0.211775,0.211193,0.202322,0.191541,0.16836,0.162512,0.162428,0.160065,0.145444,0.145239,0.142928,0.140984,0.140491,0.140073,0.138793,0.138247,0.137973,0.137387,0.137266,0.136701,0.117346,0.113618,0.0850753,0.0828754,0.0770289,0.0660228,0.0614711,0.0316525,0.0288053,0.0178315,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
1640179668	cand_summary_sent_ids	The place is:CPUPlace
Tensor[argsort_0.tmp_1_slice_0]
	shape: [1,10,1,]
	dtype: l
	data: 1,10,3,49,11,28,30,8,37,5,
1640179694	sent_labels_weight	The place is:CPUPlace
Tensor[read_file_0.tmp_7]
	shape: [2,3,24,1,]
	dtype: f
	data: 1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
1640179694	sent_scores	The place is:CPUPlace
Tensor[sent_score_fc.tmp_2]
	shape: [2,3,24,1,]
	dtype: f
	data: 0.378274,0.169354,0.50244,0.507422,0.38298,0.304847,0.374783,0.11399,0.11399,0.11399,0.11399,0.11399,0.11399,0.11399,0.11399,0.11399,0.11399,0.11399,0.11399,0.11399,0.11399,0.11399,0.11399,0.11399,0.456433,0.347677,0.527049,0.43733,0.348275,0.208299,0.145646,0.4419,0.0240435,0.0946672,0.0946672,0.0946672,0.0946672,0.0946672,0.0946672,0.0946672,0.0946672,0.0946672,0.0946672,0.0946672,0.0946672,0.0946672,0.0946672,0.0946672,0.71397,0.375579,0.376343,0.454462,0.153899,0.384244,0.426575,0.202011,0.330919,0.227666,0.292813,0.198246,0.250549,0.163324,0.163324,0.163324,0.163324,0.163324,0.163324,0.163324,0.163324,0.163324,0.163324,0.163324,0.036775,0.270233,0.307467,0.568395,0.174212,0.164102,0.261685,0.33092,0.30326,0.207343,0.262896,0.274409,0.329465,0.117892,0.125096,0.0665847,0.0483232,0.0313775,0.071759,0.071759,0.071759,0.071759,0.071759,0.071759,0.391267,0.358815,0.282676,0.194141,0.204981,0.0917193,0.115227,0.350619,0.171305,0.205715,0.131321,0.202299,0.0912919,0.241685,0.0288223,0.0744297,0.0889162,0.0921357,0.110148,0.0867651,0.0695125,0.0688509,0.0545262,0.0640643,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,0.00333591,
1640179694	correct_scores	The place is:CPUPlace
Tensor[elementwise_mul_1.tmp_0]
	shape: [2,3,24,1,]
	dtype: f
	data: 0.378274,0.169354,0.50244,0.507422,0.38298,0.304847,0.374783,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.456433,0.347677,0.527049,0.43733,0.348275,0.208299,0.145646,0.4419,0.0240435,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.71397,0.375579,0.376343,0.454462,0.153899,0.384244,0.426575,0.202011,0.330919,0.227666,0.292813,0.198246,0.250549,0,0,0,0,0,0,0,0,0,0,0,0.036775,0.270233,0.307467,0.568395,0.174212,0.164102,0.261685,0.33092,0.30326,0.207343,0.262896,0.274409,0.329465,0.117892,0.125096,0.0665847,0.0483232,0.0313775,0,0,0,0,0,0,0.391267,0.358815,0.282676,0.194141,0.204981,0.0917193,0.115227,0.350619,0.171305,0.205715,0.131321,0.202299,0.0912919,0.241685,0.0288223,0.0744297,0.0889162,0.0921357,0.110148,0.0867651,0.0695125,0.0688509,0.0545262,0.0640643,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
1640179694	score_sorted	The place is:CPUPlace
Tensor[argsort_1.tmp_0]
	shape: [2,72,1,]
	dtype: f
	data: 0.71397,0.527049,0.507422,0.50244,0.456433,0.454462,0.4419,0.43733,0.426575,0.384244,0.38298,0.378274,0.376343,0.375579,0.374783,0.348275,0.347677,0.330919,0.304847,0.292813,0.250549,0.227666,0.208299,0.202011,0.198246,0.169354,0.153899,0.145646,0.0240435,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.568395,0.391267,0.358815,0.350619,0.33092,0.329465,0.307467,0.30326,0.282676,0.274409,0.270233,0.262896,0.261685,0.241685,0.207343,0.205715,0.204981,0.202299,0.194141,0.174212,0.171305,0.164102,0.131321,0.125096,0.117892,0.115227,0.110148,0.0921357,0.0917193,0.0912919,0.0889162,0.0867651,0.0744297,0.0695125,0.0688509,0.0665847,0.0640643,0.0545262,0.0483232,0.036775,0.0313775,0.0288223,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
1640179694	cand_summary_sent_ids	The place is:CPUPlace
Tensor[argsort_0.tmp_1_slice_0]
	shape: [2,10,1,]
	dtype: l
	data: 48,26,3,2,24,51,31,27,54,53,3,24,25,31,7,12,2,8,26,11,
1640179704	sent_labels_weight	The place is:CPUPlace
Tensor[read_file_0.tmp_7]
	shape: [1,2,28,1,]
	dtype: f
	data: 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
1640179704	sent_scores	The place is:CPUPlace
Tensor[sent_score_fc.tmp_2]
	shape: [1,2,28,1,]
	dtype: f
	data: 0.233336,0.194979,0.751827,0.470303,0.22486,0.218756,0.336966,0.340234,0.241208,0.277304,0.183472,0.121561,0.184776,0.158553,0.113318,0.126607,0.143522,0.116418,0.253592,0.114201,0.173447,0.126873,0.106207,0.0999668,0.0936093,0.0952917,0.0910817,0.0889307,0.311421,0.118113,0.227312,0.071949,0.19366,0.0706528,0.102781,0.0890734,0.0115324,0.116256,0.0233125,0.0166036,0.0109918,0.127976,0.0402762,0.0278832,0.0310848,0.0363171,0.0386973,0.0379318,0.0371169,0.0370682,0.0373626,0.0368113,0.0363387,0.0359217,0.035741,0.0403775,
1640179704	correct_scores	The place is:CPUPlace
Tensor[elementwise_mul_1.tmp_0]
	shape: [1,2,28,1,]
	dtype: f
	data: 0.233336,0.194979,0.751827,0.470303,0.22486,0.218756,0.336966,0.340234,0.241208,0.277304,0.183472,0.121561,0.184776,0.158553,0.113318,0.126607,0.143522,0.116418,0.253592,0.114201,0.173447,0.126873,0.106207,0.0999668,0.0936093,0.0952917,0.0910817,0.0889307,0.311421,0.118113,0.227312,0.071949,0.19366,0.0706528,0.102781,0.0890734,0.0115324,0.116256,0.0233125,0.0166036,0.0109918,0.127976,0.0402762,0.0278832,0.0310848,0.0363171,0.0386973,0.0379318,0.0371169,0.0370682,0.0373626,0.0368113,0.0363387,0.0359217,0.035741,0,
1640179704	score_sorted	The place is:CPUPlace
Tensor[argsort_1.tmp_0]
	shape: [1,56,1,]
	dtype: f
	data: 0.751827,0.470303,0.340234,0.336966,0.311421,0.277304,0.253592,0.241208,0.233336,0.227312,0.22486,0.218756,0.194979,0.19366,0.184776,0.183472,0.173447,0.158553,0.143522,0.127976,0.126873,0.126607,0.121561,0.118113,0.116418,0.116256,0.114201,0.113318,0.106207,0.102781,0.0999668,0.0952917,0.0936093,0.0910817,0.0890734,0.0889307,0.071949,0.0706528,0.0402762,0.0386973,0.0379318,0.0373626,0.0371169,0.0370682,0.0368113,0.0363387,0.0363171,0.0359217,0.035741,0.0310848,0.0278832,0.0233125,0.0166036,0.0115324,0.0109918,0,
1640179704	cand_summary_sent_ids	The place is:CPUPlace
Tensor[argsort_0.tmp_1_slice_0]
	shape: [1,10,1,]
	dtype: l
	data: 2,3,7,6,28,9,18,8,0,30,
